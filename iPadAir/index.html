<!-- button 改成 radio -->
<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
        <link rel="stylesheet" href="reset.css">
        <link rel="stylesheet" href="style.css">
        <title>Hello, world!</title>
    </head>
    <body>
        <div class="container">
            <div class="row row-cols-1 row-cols-md-2">
                <div class="col">
                    <div class="product-img">
                        <img src="" alt="">
                    </div>
                    <!-- <ul class="service">
                        <li class="service-item">
                            <i></i>
                            <p>免額外付費的運送服務</p>
                        </li>
                        <li class="service-item">
                            <i></i>
                            <p>免額外付費的個人化鐫刻服務</p>
                        </li>
                        <li class="service-item">
                            <i></i>
                            <p>免額外付費輕鬆退貨</p>
                        </li>
                    </ul> -->
                </div>
                <div class="col pt-5 accordion" id="accordion">

                    <!-- 選擇前：wrap、選擇後：wrap-selected -->
                    <div class="color wrap accordion-item" id="color">
                        <p class="option-title accordion-header d-flex" id="panelsStayOpen-headingOne">
                            <button class="accordion-button collapsed">
                                外觀
                                <button class="btn-edit" type="button" aria-expanded="true"  data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseOne" aria-controls="panelsStayOpen-collapseOne">更改</button>
                            </button>
                        </p>
                        <!-- <button class="btn-edit">更改</button> -->
                        <div id="panelsStayOpen-collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#accordion">
                            <div class="options d-flex flex-wrap accordion-body">
                            </div>
                        </div>
                    </div>

                    <div class="storage wrap accordion-item" id="storage">
                        <p class="option-title accordion-header d-flex" id="panelsStayOpen-headingTwo">
                            <button class="accordion-button collapsed">
                                儲存裝置
                                <button class="btn-edit" type="button" aria-expanded="true"  data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseTwo" aria-controls="panelsStayOpen-collapseTwo">更改</button>
                            </button>
                        </p>
                        <div id="panelsStayOpen-collapseTwo" class="accordion-collapse collapse show" aria-labelledby="panelsStayOpen-headingTwo" data-bs-parent="#accordion">
                            <p class="option-description">提前為日後預留空間。你的 iPad 儲存空間愈大，你就有愈多空間儲存數位內容，滿足現在和未來所需。</p>
                            <div class="options d-flex flex-wrap accordion-body">
                            </div>
                        </div>
                    </div>

                    <div class="wifi wrap accordion-item" id="wifi">
                        <p class="option-title accordion-header d-flex" id="panelsStayOpen-headingThree">
                            <button class="accordion-button collapsed">
                                連線能力
                                <button class="btn-edit" type="button" aria-expanded="true"  data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseThree" aria-controls="panelsStayOpen-collapseThree">更改</button>
                            </button>
                        </p>
                        <div id="panelsStayOpen-collapseThree" class="accordion-collapse collapse show" aria-labelledby="panelsStayOpen-headingThree" data-bs-parent="#accordion">
                            <p class="option-description">兩種快速的方式，讓你時時保持聯繫。每部 iPad 都可連接到 Wi-Fi 網路。Wi-Fi + 行動網路機型則讓你在無法使用 Wi-Fi 時，也能連上線。</p>
                            <div class="options d-flex flex-wrap accordion-body">
                            </div>
                        </div>
                    </div>
                    <div class="price-area disable">
                        <p class="result-price">NT 18,900 起</p>
                        <div class="discount-plan">
                            <p class="title">加入換購方案</p>
                            <div class="description d-flex">
                                <p class="info">Apple Trade In 換購方案
                                    透過「Apple Trade In 換購方案」，以你符合條件的平板電腦換購，獲享折抵退款。你也可選擇免額外付費回收**。</p>
                                <a href="" class="see-more">開始進行</a>
                            </div>
                        </div>
                        <a href="" class="next">繼續</a>
                    </div>
                </div>
            </div>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
        <script>
            let projectImg;
            let sumPrice = 18900;
            let res = document.querySelector('.result-price');

            function selectColor(e){
                // Q: 有時候抓不到圖片？
                let img = e.target.dataset.productImg;
                if(img != undefined){
                    projectImg.setAttribute('src', img);
                    selectItem(0, e.currentTarget.dataset.spec);
                }
            }
            function selectStorage(e){
                sumPrice = parseInt(e.currentTarget.dataset.price);
                res.innerText = `NT $${sumPrice} 起`;

                selectItem(1, e.currentTarget.dataset.spec);
            }
            function selectWifi(e){
                sumPrice += parseInt(e.currentTarget.dataset.price);
                res.innerText = `NT $${sumPrice}`;

                selectItem(2, e.currentTarget.dataset.spec);
            }
            function selectItem(index, title){
                let wrapArray = ["color", "storage", "wifi"];
                let wrap = document.querySelector(`#${wrapArray[index]}`);
                let editBtn = document.querySelector('.btn-edit');
                wrap.querySelector('.option-title>button').innerText = title;
                wrap.classList.add('selected');
                
                // 折疊效果
                wrap.querySelector('.accordion-collapse').classList.remove('show');
                // editBtn.classList.remove('d-none');
                // 更改按鈕

                // anchor next wrap

            } 
        </script>
        <script type="module">
            import {create, select} from './functions.js';
            import { data } from './iPadAir.js';
            import { getColorSpec, getStorageSpec, getWifiSpec } from './getDefaultData.js';

            window.onload = () => {
                projectImg = select('.product-img>img');
                projectImg.setAttribute('src', data.productsData.defaultImg);
                projectImg.setAttribute('class', 'w-100');

                getColorSpec();
                getStorageSpec();
                getWifiSpec();
            }
        </script>
    </body>
</html>